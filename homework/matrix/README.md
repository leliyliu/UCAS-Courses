# PLU 分解 与矩阵求逆

### 函数主体内容

#### PLU分解

PLU分解过程主要包含了几个基本计算内容：

+ 寻找主元并交换行（同时交换A, L, P矩阵，其中P矩阵初始化为单位矩阵）
+ 根据找到的主元，消去该列的其他行，并设置L 矩阵该行的内容
+ 根据原矩阵的行和得到的L 矩阵的列，求出消去的A矩阵
+ 重复上述过程，将A矩阵变为U矩阵
+ 最终返回矩阵P , L , U

#### 矩阵求逆

根据分析，有 
$$
PA = LU \\
AA^{-1} = E \\ 
LUA^{-1} = P 
$$
所以需要求解两个主要的方程，也就是求解
$$
LM = P \\  
UA^{-1} = M
$$
根据其结果进行一列一列的求解。

由于L 是下三角矩阵，而U 是上三角矩阵，故在求解过程中，可以进一步进行优化，直接利用带入求解的方式求出相应的内容即可。

对于上三角矩阵，应从最后一行开始带入求解

而对于下三角矩阵，应从第一行开始带入求解

输入示例

#### 1.

$$
\begin{bmatrix}
4 & 0 & 4 \\
6 & 0 & 3 \\
3 & 7 & 5
\end{bmatrix}
$$

#### 2. 

$$
\begin{bmatrix}
1 & 2 & 4 & 17 \\ 
3 & 6 & -12 & 3 \\ 
2 & 3 & -3 & 2 \\ 
0 & 2 & -2 & 6 
\end{bmatrix}
$$



### 输出示例

#### 1. 

$$
\begin{bmatrix}
-0.25 & 0.33 & 0 \\
-0.25 & 0.095 & 0.14 \\
0.5 & -0.33 & 0
\end{bmatrix}
$$



#### 2. 

$$
\begin{bmatrix}
0.35 & 0.35 & -0.2 & -1.1 \\ 
-0.375 & -0.542 & 1 & 1 \\ 
-0.075 & -0.242 & 0.4 & 0.2 \\ 
0.1 & 0.1 & -0.2 & 0.1 
\end{bmatrix}
$$



### 程序正确性比对

这里利用了自己实现的求逆算法和python numpy 中自带的算法进行了比较，由于存在一定的精度误差（$\lambda$），故这里的比较条件为 
$$
sum(Ainv - M) < \lambda
$$
其中$Ainv$代表我们所求出来的$A$的逆矩阵，而$M$表示用numpy自带方法求出来的逆矩阵。最终经过多次试验，表明了本程序的正确性。